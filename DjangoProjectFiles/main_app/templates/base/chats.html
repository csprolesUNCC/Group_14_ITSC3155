{% extends 'main.html' %}

{% block content %}

<style>

    .chats-page-container {
        display: grid;
        grid-template-columns: 300px 1fr;
    }

    .main-block {
        padding-left: 5px;
    }

    .find-usr {
        display: flex;
        flex-direction: row;
        gap: 5px;
    }

    .find-usr input {
        height: 25px;
    }

    .select-usr button {
        width: 100%;
        padding-top: 2px;
        padding-bottom: 2px;
    }

    .select-usr {
        padding: 1px;
    }

    .chats-page-container button {
        cursor: pointer;
    }

    .chats-page-container h1 {
        text-align: center;
    }

    .chat {
        padding-top: 10px;
    }

    .chat-header {
        display: flex;
        justify-content: space-between;
    }

</style>

<div class="chats-page-container">
    
    <div class="sidebar">
      
        <h1>Chats</h1>

        <form method="GET" action="" class="find-usr">
            <input name="usr" type="text" placeholder="Start a chat with...">
        </form>

        {% for username in chatterUsernames %}

            <form method="GET" action="" class="select-usr">
                <button type="submit" name="usr" value="{{username}}">{{username}}</button>
            </form>

        {% endfor %}

    </div>
    
    <div class="main-block">
        
        {% if userSelected %}

            <h1>{{receiver}}</h1>

            <form action="" method="POST" class="find-usr">
                {% csrf_token %}
                <input type="text" name="msg" placeholder="Send a message...">
            </form>

            {% for chat in chats %}

                {% if chat.sender == receiver or chat.receiver == receiver %}

                    <div class="chat">
                        <div class="chat-header">
                            <a><strong>From: {{chat.sender}}</strong></a>
                            <small>Sent on {{chat.time_sent}}</small>
                        </div>
                        <a>{{chat.body}}</a>
                    </div>

                {% endif %}

            {% endfor %}

        {% else %}

            <h1>Select or Start a Chat With Someone!</h1>

        {% endif %}

    </div>

</div>

{% endblock content %}
